<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Pymagra.utilities.utilities &#8212; pymagra 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/nature.css?v=0f882399" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=fd3f3429" />
    <script src="../../../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Pymagra.PyMaGra" href="../../PyMaGra/index.html" />
    <link rel="prev" title="Pymagra.utilities" href="../index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../PyMaGra/index.html" title="Pymagra.PyMaGra"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Pymagra.utilities"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pymagra 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../index.html" >Pymagra</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" accesskey="U">Pymagra.utilities</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Pymagra.utilities.utilities</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-Pymagra.utilities.utilities">
<span id="pymagra-utilities-utilities"></span><h1>Pymagra.utilities.utilities<a class="headerlink" href="#module-Pymagra.utilities.utilities" title="Link to this heading">¶</a></h1>
<p>Last modified on Aug. 26, 2024</p>
<dl class="simple">
<dt>&#64;author: Hermann Zeyen &lt;<a class="reference external" href="mailto:hermann&#46;zeyen&#37;&#52;&#48;universite-paris-saclay&#46;fr">hermann<span>&#46;</span>zeyen<span>&#64;</span>universite-paris-saclay<span>&#46;</span>fr</a>&gt;</dt><dd><p>Université Paris-Saclay, France</p>
</dd>
</dl>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities" title="Pymagra.utilities.utilities.Utilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Utilities</span></code></a></p></td>
<td><p>Contains the following utility functions for program PyMaGra:</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Pymagra.utilities.utilities.</span></span><span class="sig-name descname"><span class="pre">Utilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">main</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities" title="Link to this definition">¶</a></dt>
<dd><p>Contains the following utility functions for program PyMaGra:</p>
<blockquote>
<div><ul class="simple">
<li><p>extract</p></li>
<li><p>clean_data</p></li>
<li><p>diurnal_correction</p></li>
<li><p>diurnal_variation</p></li>
<li><p>interpol_line</p></li>
<li><p>interpol_2D</p></li>
<li><p>extrapolate</p></li>
<li><p>gauss_transform</p></li>
<li><p>justify_lines_gaussian</p></li>
<li><p>matrixExtension</p></li>
<li><p>pole_Reduction</p></li>
<li><p>continuation</p></li>
<li><p>analyticSignal</p></li>
<li><p>horizontalDerivative2</p></li>
<li><p>horizontalDerivative</p></li>
<li><p>horizontalDerivative2</p></li>
<li><p>tilt</p></li>
</ul>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.main">
<span class="sig-name descname"><span class="pre">main</span></span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.month_base">
<span class="sig-name descname"><span class="pre">month_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.month_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.day_base">
<span class="sig-name descname"><span class="pre">day_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.day_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.year_base">
<span class="sig-name descname"><span class="pre">year_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.year_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.hour_base">
<span class="sig-name descname"><span class="pre">hour_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.hour_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.minute_base">
<span class="sig-name descname"><span class="pre">minute_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.minute_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.second_base">
<span class="sig-name descname"><span class="pre">second_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.second_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.time_base">
<span class="sig-name descname"><span class="pre">time_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.time_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.jday_base">
<span class="sig-name descname"><span class="pre">jday_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.jday_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.base">
<span class="sig-name descname"><span class="pre">base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.grad_inter">
<span class="sig-name descname"><span class="pre">grad_inter</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.grad_inter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.extract">
<span class="sig-name descname"><span class="pre">extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">choice</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.extract" title="Link to this definition">¶</a></dt>
<dd><p>Mark data segments for treatment as function of odd or even line number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>choice</strong> (<em>tuple</em><em> of </em><em>str</em>) – <p>may be:</p>
<ul class="simple">
<li><p>”all” (choose all lines)</p></li>
<li><p>”odd” (choose odd lines, natural counting)</p></li>
<li><p>”even” (choose even line numbers, natural counting)</p></li>
<li><p>”N”, “S”, “W” or “E”</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.data_flatten">
<span class="sig-name descname"><span class="pre">data_flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.data_flatten" title="Link to this definition">¶</a></dt>
<dd><p>Data that are stored in dictionary data with one entrance per line are
concatenated into one 1D numpy array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dictionary with keys equal to line number</em>) – <p>contains for every line itself a dictionary with the following keys:</p>
<ul class="simple">
<li><p>”s1” : Data of sensor 1</p></li>
<li><p>”s2” : Data of sensor 2</p></li>
<li><p>”x”, “y”, “z”: Coordinates of data</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s1</strong> (<em>Numpy 1D float array</em>) – Concatenated data of sensor 1</p></li>
<li><p><strong>s2</strong> (<em>Numpy 1D float array</em>) – Concatenated data of sensor 2</p></li>
<li><p><strong>x</strong> (<em>Numpy 1D float array</em>) – Concatenated x-coordinates of all data</p></li>
<li><p><strong>y</strong> (<em>Numpy 1D float array</em>) – Concatenated y-coordinates of all data</p></li>
<li><p><strong>z</strong> (<em>Numpy 1D float array</em>) – Concatenated z-coordinates of all data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.clean_data">
<span class="sig-name descname"><span class="pre">clean_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.clean_data" title="Link to this definition">¶</a></dt>
<dd><p>Set data to np.nan under certain conditions which may be:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dictionary</em>) – Contains data to be cleaned (see io.get_line).</p></li>
<li><p><strong>min_fix</strong> (<em>float</em>) – All data below this value are set to nan.</p></li>
<li><p><strong>max_fix</strong> (<em>float</em>) – All data above this value are set to nan.</p></li>
<li><p><strong>percent_down</strong> (<em>float</em>) – The lowermost percentile values are set to nan
A value of 0.01 means that all values lower than the
1% quantile are set to None.</p></li>
<li><p><strong>percent_up</strong> (<em>float</em>) – The uppermost percentile values are set to nan
A value of 0.01 means that all values higher than the
99% quantile are set to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Same structure as inpput data, but with with data outside defined
limits set to np.nan</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.julian2date">
<span class="sig-name descname"><span class="pre">julian2date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j_day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.julian2date" title="Link to this definition">¶</a></dt>
<dd><p>Function translates Julian day number to standard date.
1st of January is Julian day number 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>j_day</strong> (<em>int</em>) – Number of Julian day</p></li>
<li><p><strong>year</strong> (<em>int</em>) – Year in which to do the calculation (important to know whether
it is a leap year). May be 2 or 4 ciphers</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>day</strong> (<em>int</em>) – Day of month</p></li>
<li><p><strong>month</strong> (<em>int</em>) – Month in year</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.date2julian">
<span class="sig-name descname"><span class="pre">date2julian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.date2julian" title="Link to this definition">¶</a></dt>
<dd><p>Function translates month and day of month to Julian day of year.
1st of January is Julian day number 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>day</strong> (<em>int</em>) – Day of month (natural counting, starts at 1)</p></li>
<li><p><strong>month</strong> (<em>int</em>) – Month of year (natural counting, starts at 1 for January)</p></li>
<li><p><strong>year</strong> (<em>int</em>) – Year in which to do the calculation (important to know whether
it is a leap year). May be 2 or 4 ciphers</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>j_day</strong> – Julian day of year</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.time2data">
<span class="sig-name descname"><span class="pre">time2data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.time2data" title="Link to this definition">¶</a></dt>
<dd><p>Convert seconds into julian day of year, hour, minute and second</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time</strong> (<em>may be a single float</em><em> or </em><em>a 1D numpy array</em>) – Time to be converted [s], based on julian day of year, i.e.
time = julian_day*86000+hour*3600+minute*60+second.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>All returned parameters have the same shape as time.</em></p></li>
<li><p><strong>month</strong> (<em>int</em>) – month of year</p></li>
<li><p><strong>day</strong> (<em>int</em>) – day of month.</p></li>
<li><p><strong>h</strong> (<em>int</em>) – Hour.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – minute.</p></li>
<li><p><strong>s</strong> (<em>float</em>) – second.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.diurnal_correction">
<span class="sig-name descname"><span class="pre">diurnal_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.diurnal_correction" title="Link to this definition">¶</a></dt>
<dd><p>Apply diurnal corrections
The diurnal variations may come from base station data (function read_base)
or, if no base station data exist, they are calculated in function
diurnal_variation by fitting a polynomial of degree “degree” to the
measured data. Data of different days are then fitted independently.</p>
<p>Base station data (measured or calculated) are interpolated onto
measurement times and simply subtracted from data. The process is done
in situ, i.e. the values of arrays self.sensor1 and self.sensor2 are
modified. If you need to keep the original data, you must copy them to
other arrays before applying diurnal_correction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>optional</em>) – Degree of polynom to be fitted to data. The default is 3.
This parameter is only used if no base station data exist</p></li>
<li><p><strong>diff_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – If day_joint_flag is true, diff_weight defines the relative weight
for the fit of the differences along the block edges with respect
to the fit of the medians.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.diurnal_variation">
<span class="sig-name descname"><span class="pre">diurnal_variation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.diurnal_variation" title="Link to this definition">¶</a></dt>
<dd><p>Calculate a fit of degree “degree” to the data of lines “lines” which
will be used for correction of diurnal variations if not base station
data exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lines</strong> (<em>1D numpy int array</em>) – Numbers of the lines to be used for calculation of diurnal variations.
If several files have been loaded, acquired at different days, the
fit may be calculated independently for every day.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>optional</em>) – Degree of polynom to be fitted to data. The default is 3.</p></li>
<li><p><strong>diff_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – If all blocks are inverted together, diff_weight is the weight
given to fit of differences along the edges with respect to fit
of medians in each block. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Polynome coefficients (1D numpy array of size degree+1)</em> – The polynome is calculated as
P[degree]+P[degree-1]*x+P[degree-2]*x**2…+P[0]*x**degree
If multiple blocks are fitted together, P contains a polynome for
each block, i.e. len(P) = (degree+1)*number_of_blocks</p></li>
<li><p><strong>tmn</strong> (<em>float</em>) – For the stability of polynome fit, times (given in seconds) are
reduced such that the minimum time is zero. tmn is this minumum time.
To apply the coefficients to data, their time must be transformed to
time-tmn before applying the polynome coefficients</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.interpol_line">
<span class="sig-name descname"><span class="pre">interpol_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.interpol_line" title="Link to this definition">¶</a></dt>
<dd><p>interpolate data of one line onto a regular grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_line</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of line to be interpolated (counting starts at 0). The default is 0.</p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>optional</em>) – Sampling step in meters for interpolated data. The default is 0.2.</p></li>
<li><p><strong>xmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Position of first sample along self.direction in meters. The default is 0.</p></li>
<li><p><strong>xmax</strong> (<em>If xmin ==</em>) – Position of last sample along self.direction in meters. The default is 0.</p></li>
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>optional</em>) – <p>Degree of spline used for interpolation. The default is 3.
See scipy.interpolate.interp1d for more information. Only splines are used.
Correspondance between k and “kind” of scipy.interpolate.interp1d:</p>
<ul>
<li><p>k=0: kind=”zero”</p></li>
<li><p>k=1: kind=”slinear”</p></li>
<li><p>k=2: kind=”quadratic”</p></li>
<li><p>k=3: kind=”cubic”</p></li>
</ul>
</p></li>
<li><p><strong>xmax</strong></p></li>
<li><p><strong>automatically.</strong> (<em>the starting and end points are calculated</em>)</p></li>
<li><p><strong>this</strong> (<em>For</em>)</p></li>
<li><p><strong>for</strong> (<em>the starting point is placed at the nearest multiple</em><em> of </em><em>dx</em>)</p></li>
<li><p><strong>read_stn</strong><strong>)</strong> (<em>the coordinate</em><em> of </em><em>self.direction</em><em> (</em><em>see function</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sensor_inter</strong> (<em>numpy float array</em>) – Interpolated data</p></li>
<li><p><strong>x_inter</strong> (<em>numpy float array</em>) – Interpolated X-coordinates</p></li>
<li><p><strong>y_inter</strong> (<em>numpy float array</em>) – Interpolated Y-coordinates</p></li>
<li><p><strong>dmin</strong> (<em>float</em>) – Position of first interpolated point within line [m]</p></li>
<li><p><strong>dmax</strong> (<em>float</em>) – Position of last interpolated point within line [m]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.interpol_2D">
<span class="sig-name descname"><span class="pre">interpol_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.interpol_2D" title="Link to this definition">¶</a></dt>
<dd><p>Routine interpolates data on all lines onto a regular grid. No extrapolation
is done, i.e. if at the beginning or the end of a line data are missing
(the line starts later than others or stops earlier), the interpolated
array will contain nans
The interpolation method used is scipy.interpolate.CloughTocher2DInterpolator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>optional</em>) – Sampling step in meters in x-direction. The default is 0.2.</p></li>
<li><p><strong>dx</strong> – Sampling step in meters in y-direction. The default is 0.2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sensor1_inter</strong> (<em>2D numpy float array</em>) – Contains gridded data of sensor 1</p></li>
<li><p><strong>sensor2_inter</strong> (<em>2D numpy float array</em>) – Contains gridded data of sensor 2</p></li>
<li><p><strong>grad_inter</strong> (<em>2D numpy float array</em>) – contains the vertical gradient</p></li>
<li><p><em>The shape of the arrays depends on the principal direction of the lines</em></p></li>
<li><p><em>- If self.direction == 1, shape is (number_of_data_points_per_line, number_of_lines)</em></p></li>
<li><p><strong>- else</strong> (<em>(number_of_lines, number_of_data_points_per_line)</em>)</p></li>
<li><p><strong>x_inter</strong> (<em>1D numpy float array</em>) – x_coordinates of the columns of s1_inter and s2_inter</p></li>
<li><p><strong>y_inter</strong> (<em>1D numpy float array</em>) – y_coordinates of the rows of s1_inter and s2_inter</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.extrapolate" title="Link to this definition">¶</a></dt>
<dd><p>Routine fills nans on an interpolated grid.
For this, it searches first for every line and column the first and last
existing (non-nan) points. Then, for every non-defined point, it searches
the “n_nearest” nearest points (see first command line) and associates
a weighted average value. The weight is calculated as 1/distance**2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>2D numpy array</em>) – Contains data on regular grid. NaN for inexistant data. Shape: (ny,nx)</p></li>
<li><p><strong>x</strong> (<em>1D numpy array</em>) – Coordiantes of the columns of data</p></li>
<li><p><strong>y</strong> (<em>1D numpy array</em>) – Coordiantes of the rows of data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Contains full regular grid of data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy array with the same shape as input data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.justify_lines_median">
<span class="sig-name descname"><span class="pre">justify_lines_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">just</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.justify_lines_median" title="Link to this definition">¶</a></dt>
<dd><p>Often the measurment direction has an influence on magnetic data due to
uncorrected effects of acquisition instrumentation.
The function calculates the median values of every line and adjusts the
one of every second line to the average median of the neighbouring lines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>just</strong> (<em>int</em><em>, </em><em>optional</em>) – If 0: Leave medians of even line (python counting, i.e. first line is even)
untouched, justify odd lines to medians of even lines.
If 1: Do the reverse</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, justified data are back-copied to self.sensorN_inter and True
is returned. If not, new arrays are returned The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s1_justified</strong> (<em>1D numpy array with justified data of first sensor</em>)</p></li>
<li><p><strong>s2_justified</strong> (<em>1D numpy array with justified data of second sensor</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.gauss_transform">
<span class="sig-name descname"><span class="pre">gauss_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_fix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_move</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.gauss_transform" title="Link to this definition">¶</a></dt>
<dd><p>Transforms data sets to gaussian distribution does a projection
of the second data set onto the distribution of the first and returns
the back-transformed modified second data set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_fix</strong> (<em>numpy 1D array</em>) – Reference data set.</p></li>
<li><p><strong>data_move</strong> (<em>numpy 1D array</em>) – Data set to be projected onto the gaussian distribution of data_fix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modified data_move array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy 1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.justify_lines_gaussian">
<span class="sig-name descname"><span class="pre">justify_lines_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">just</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.justify_lines_gaussian" title="Link to this definition">¶</a></dt>
<dd><p>Often the measurment direction has an influence on magnetic data due to
uncorrected effects of acquisition instrumentation.
The function calculates the median values of every line and adjusts the
one of every second line to the average median of the neighbouring lines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>just</strong> (<em>int</em><em>, </em><em>optional</em>) – If 0: Leve medians of even line (python counting, i.e. first line is even)
untouched, justify odd lines to medians of even lines
If 1: Do the reverse</p></li>
<li><p><strong>local</strong> (<em>int</em><em>, </em><em>optional</em>) – If 0: apply gaussian transform to the whole data set
If 1: apply gaussian transform only to neighboring lines</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, justified data are back-copied to self.sensorN_inter and True
is returned. If not, new arrays are returned The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s1_justified</strong> (<em>2D numpy float array</em>) – Justified data of first sensor</p></li>
<li><p><strong>s2_justified</strong> (<em>2D numpy float array</em>) – Justified data of second sensor</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.matrixExtension">
<span class="sig-name descname"><span class="pre">matrixExtension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.matrixExtension" title="Link to this definition">¶</a></dt>
<dd><p>Creation of extended matix for 2D Fourier transform.
The toutine mirrors the lower half of the matrix and adds it at the bottom
and mirrors the upper half to the top. Equivalently right and left</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>2D numpy array</em>) – Data matrix to be extended</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>d</strong> – (ny1,nx1): Tuple with starting indices of the original data in matrix d
(ny2,nx2): Tuple with final indices of the original data in matrix d plus one
The original data may thus be retrieved as
data = d[ny1:ny2,nx1:nx2]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy array extended in both directions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.pole_Reduction">
<span class="sig-name descname"><span class="pre">pole_Reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Inc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.pole_Reduction" title="Link to this definition">¶</a></dt>
<dd><p>Calculation of pole-reduced magnetic data supposing only induced magnetization
Formula from Keating and Zerbo, Geophysics 61, nᵒ 1 (1996): 131‑137.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D numpy float array</em>) – Original magnetic data interpolated on a regular grid which may have
different grid width in x (E-W) and y (N-S) direction.</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – grid step in x direction.</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – grid step in y direction.</p></li>
<li><p><strong>Inc</strong> (<em>float</em>) – Inclination of magnetic field [degrees].</p></li>
<li><p><strong>Dec</strong> (<em>float</em>) – Declination of magnetic field [degrees].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>d</strong> – Reduced to the pole magnetic data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array with the same shape as data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.continuation">
<span class="sig-name descname"><span class="pre">continuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.continuation" title="Link to this definition">¶</a></dt>
<dd><p>Vertical continuation of potential field data using Fourier transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D numpy float array</em>) – Data interpolated onto a regular grid</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – Distance to continue data [m], positive upwards</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Prolongated data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array, same shape as data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.analyticSignal">
<span class="sig-name descname"><span class="pre">analyticSignal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.analyticSignal" title="Link to this definition">¶</a></dt>
<dd><p>Calculation of analytical signal of potential field data via
vertical and horizontal derivatives</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D numpy float array</em>) – Data interpolated onto a regular grid</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Analytic signal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array, same shape as data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.horizontalDerivative2">
<span class="sig-name descname"><span class="pre">horizontalDerivative2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.horizontalDerivative2" title="Link to this definition">¶</a></dt>
<dd><p>Second horizontal derivative of potential field data using Fourier transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D numpy float array</em>) – Data interpolated onto a regular grid</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2nd horizontal derivative of data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array, same shape as data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.horizontalDerivative">
<span class="sig-name descname"><span class="pre">horizontalDerivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.horizontalDerivative" title="Link to this definition">¶</a></dt>
<dd><p>First horizontal derivative of potential field data using Fourier transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D numpy float array</em>) – Data interpolated onto a regular grid</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>First horizontal derivative of data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array, same shape as data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.verticalDerivative2">
<span class="sig-name descname"><span class="pre">verticalDerivative2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.verticalDerivative2" title="Link to this definition">¶</a></dt>
<dd><p>Second vertical derivative of potential field data using finite differences</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>2D numpy float array</em>) – Data interpolated onto a regular grid</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2nd vertical derivative of data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array, same shape as data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.verticalDerivative">
<span class="sig-name descname"><span class="pre">verticalDerivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.verticalDerivative" title="Link to this definition">¶</a></dt>
<dd><p>First vertical derivative of potential field data using Fourier transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D numpy float array</em>) – Data interpolated onto a regular grid</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>First vertical derivative of data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array, same shape as data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Pymagra.utilities.utilities.Utilities.tilt">
<span class="sig-name descname"><span class="pre">tilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Pymagra.utilities.utilities.Utilities.tilt" title="Link to this definition">¶</a></dt>
<dd><p>Tilt angle of potential field data using Fourier transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D numpy float array</em>) – Data interpolated onto a regular grid</p></li>
<li><p><strong>grad</strong> (<em>2D numpy float array</em>) – Vertical derivative of data if it has been measured</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – Grid spacing in x and y direction [m]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tilt angle of data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D numpy float array, same shape as data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Pymagra.utilities.utilities</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities"><code class="docutils literal notranslate"><span class="pre">Utilities</span></code></a><ul>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.main"><code class="docutils literal notranslate"><span class="pre">Utilities.main</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.month_base"><code class="docutils literal notranslate"><span class="pre">Utilities.month_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.day_base"><code class="docutils literal notranslate"><span class="pre">Utilities.day_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.year_base"><code class="docutils literal notranslate"><span class="pre">Utilities.year_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.hour_base"><code class="docutils literal notranslate"><span class="pre">Utilities.hour_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.minute_base"><code class="docutils literal notranslate"><span class="pre">Utilities.minute_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.second_base"><code class="docutils literal notranslate"><span class="pre">Utilities.second_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.time_base"><code class="docutils literal notranslate"><span class="pre">Utilities.time_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.jday_base"><code class="docutils literal notranslate"><span class="pre">Utilities.jday_base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.base"><code class="docutils literal notranslate"><span class="pre">Utilities.base</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.grad_inter"><code class="docutils literal notranslate"><span class="pre">Utilities.grad_inter</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.extract"><code class="docutils literal notranslate"><span class="pre">Utilities.extract()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.data_flatten"><code class="docutils literal notranslate"><span class="pre">Utilities.data_flatten()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.clean_data"><code class="docutils literal notranslate"><span class="pre">Utilities.clean_data()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.julian2date"><code class="docutils literal notranslate"><span class="pre">Utilities.julian2date()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.date2julian"><code class="docutils literal notranslate"><span class="pre">Utilities.date2julian()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.time2data"><code class="docutils literal notranslate"><span class="pre">Utilities.time2data()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.diurnal_correction"><code class="docutils literal notranslate"><span class="pre">Utilities.diurnal_correction()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.diurnal_variation"><code class="docutils literal notranslate"><span class="pre">Utilities.diurnal_variation()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.interpol_line"><code class="docutils literal notranslate"><span class="pre">Utilities.interpol_line()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.interpol_2D"><code class="docutils literal notranslate"><span class="pre">Utilities.interpol_2D()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.extrapolate"><code class="docutils literal notranslate"><span class="pre">Utilities.extrapolate()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.justify_lines_median"><code class="docutils literal notranslate"><span class="pre">Utilities.justify_lines_median()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.gauss_transform"><code class="docutils literal notranslate"><span class="pre">Utilities.gauss_transform()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.justify_lines_gaussian"><code class="docutils literal notranslate"><span class="pre">Utilities.justify_lines_gaussian()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.matrixExtension"><code class="docutils literal notranslate"><span class="pre">Utilities.matrixExtension()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.pole_Reduction"><code class="docutils literal notranslate"><span class="pre">Utilities.pole_Reduction()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.continuation"><code class="docutils literal notranslate"><span class="pre">Utilities.continuation()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.analyticSignal"><code class="docutils literal notranslate"><span class="pre">Utilities.analyticSignal()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.horizontalDerivative2"><code class="docutils literal notranslate"><span class="pre">Utilities.horizontalDerivative2()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.horizontalDerivative"><code class="docutils literal notranslate"><span class="pre">Utilities.horizontalDerivative()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.verticalDerivative2"><code class="docutils literal notranslate"><span class="pre">Utilities.verticalDerivative2()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.verticalDerivative"><code class="docutils literal notranslate"><span class="pre">Utilities.verticalDerivative()</span></code></a></li>
<li><a class="reference internal" href="#Pymagra.utilities.utilities.Utilities.tilt"><code class="docutils literal notranslate"><span class="pre">Utilities.tilt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../index.html"
                          title="previous chapter">Pymagra.utilities</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../../PyMaGra/index.html"
                          title="next chapter">Pymagra.PyMaGra</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/autoapi/Pymagra/utilities/utilities/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../PyMaGra/index.html" title="Pymagra.PyMaGra"
             >next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Pymagra.utilities"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pymagra 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../index.html" >Pymagra</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Pymagra.utilities</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Pymagra.utilities.utilities</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Hermann Zeyen.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    </div>
  </body>
</html>